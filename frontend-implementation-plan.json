{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix Remove Player functionality",
  "requirements": [
    {
      "id": "REQ-22",
      "summary": "Add useRemovePlayer mutation hook that calls backend removePlayer method and invalidates ranking cache",
      "acceptanceCriteria": [
        "A `useRemovePlayer` hook is exported from useQueries.ts",
        "The hook calls the backend actor's `removePlayer` method with the target player UUID",
        "On success, the query cache for all category rankings is invalidated so the table re-fetches and reflects the removal"
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Add a `useRemovePlayer` mutation hook that accepts a UUID string, calls actor.removePlayer(uuid), and on success invalidates the query cache keys ['rawRankingData', 'allPlayers', 'searchPlayers', and any 'playersByCategory'] to trigger a refetch of ranking data across all views"
        }
      ]
    },
    {
      "id": "REQ-23",
      "summary": "Fix Remove Player flow in AdminControls to skip passcode re-prompt when session is unlocked and trigger player removal",
      "acceptanceCriteria": [
        "Clicking Remove Player when already unlocked does not re-prompt the PasscodeModal",
        "Clicking Remove Player when not yet unlocked shows the PasscodeModal first, then proceeds after correct passcode entry",
        "The selected player is removed from the rankings table after the mutation completes",
        "The unlocked state is read from sessionStorage (key consistent with AdminControls existing implementation) so it persists across re-renders within the same session"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/AdminControls.tsx",
          "operation": "modify",
          "description": "Modify the Remove Player button click handler to: (1) check sessionStorage for the unlocked state key (matching the existing Add Player implementation); (2) if unlocked, immediately show a player selection/confirmation UI (e.g., a select dropdown or modal listing current players with their usernames and UUIDs) without re-prompting PasscodeModal; (3) if not unlocked, show PasscodeModal first, then proceed to player selection after successful passcode entry; (4) wire the useRemovePlayer mutation from useQueries.ts and call it with the selected player UUID; (5) ensure the mutation callback updates UI state so the player is removed from the visible table after success"
        }
      ]
    }
  ]
}